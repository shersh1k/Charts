!function(t){var e={};function a(i){if(e[i])return e[i].exports;var s=e[i]={i:i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,a),s.l=!0,s.exports}a.m=t,a.c=e,a.d=function(t,e,i){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)a.d(i,s,function(e){return t[e]}.bind(null,s));return i},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s=0)}([function(t,e,a){"use strict";a.r(e);var i=function(t){return new Promise(function(e,a){var i=new XMLHttpRequest;i.open("GET",t,!0),i.onload=function(){if(200==this.status)e(this.response);else{var t=new Error(this.statusText);t.code=this.status,a(t)}},i.onerror=function(){a(new Error("Network Error"))},i.send()})},s=function(t,e){let a=document.createElement("canvas");t.chart.root.appendChild(a);let i=window.devicePixelRatio||1;a.id=e+t.chart.id,a.style.width=t.area.width+"px",a.style.height=t.area.height+"px";let s=a.getBoundingClientRect();a.width=s.width*i,a.height=s.height*i,a.style.position="absolute",a.style.top=t.area.top+"px",a.style.left=t.area.left;let h=a.getContext("2d");return h.scale(i,i),h};class h{constructor(t){this.chart=t,this.area=t.geometry.LabelX,this.labelCtx=s(this,"LabelX_"),this.ChartArea=t.ChartArea,this.data=t.data,this.textWidth=this.setTextWidth()}render(){this.clear(),this.labelCtx.save(),this.labelCtx.beginPath(),this.labelCtx.font="12px sans-serif",this.labelCtx.fillStyle="rgb(155, 166, 174)",this.labelCtx.translate(-this.data.firstPixel/this.ChartArea.xScale,0);const t=Math.log2(3*this.textWidth/this.ChartArea.stepX),e=Math.round(t),a=2*(e-t);for(let t=0;t<this.data.xAxis.length;t++)this.labelCtx.font="12px sans-serif",t>=this.data.firstIndex&&t<=this.data.lastIndex&&(t%2**e==0?(this.labelCtx.fillStyle="rgb(155, 166, 174)",this.labelCtx.fillText(this.data.xAxis[t].short,t*this.ChartArea.stepX-(t?this.textWidth:0)/2,20)):t%2**(e-1)==0&&(this.labelCtx.fillStyle=`rgb(155, 166, 174, ${a})`,this.labelCtx.fillText(this.data.xAxis[t].short,t*this.ChartArea.stepX-this.textWidth/2,20)));this.labelCtx.restore()}setTextWidth(){this.labelCtx.save(),this.labelCtx.font="12px sans-serif";let t=Math.ceil(this.labelCtx.measureText(this.data.xAxis[0].short).width);return this.labelCtx.restore(),t}update(t,e,a){"click"==a.type&&console.log(this),"mousemove"==a.type&&this.changingCursor(t,e)}changingCursor(t,e){this.chart.root.style.cursor="default"}clear(){this.labelCtx.clearRect(0,0,this.area.width,this.area.height)}}var r=function(t,e,a){let i;if(i=a.data.options.stacked?s(function(t){let e=[],a=[];return a.push(0),e=[],t.datasets.forEach(t=>{e.length?t.data.forEach((t,a)=>{e[a]+=t}):e=t.data.slice()}),a.push(Math.max(...e)),a}(t)):a.data.options.y_scaled?function(t){let e=t[1][0]-t[0][0],i=Math.ceil(e/5.9),s=i.toString().length-1,h=Math.ceil(i/10**s)*10**s,r=Math.floor(t[0][0]/10**s)*10**s,l=r+6*h>0?r+6*h:0,o=t[1][1]-t[0][1],n=Math.ceil(o/5.9),d=n.toString().length-1,c=Math.ceil(n/10**d)*10**d,u=Math.floor(t[0][1]/10**d)*10**d,m=u+6*c>0?u+6*c:0;return a.data.secondYminmax=[u,m,c],a.data.mnojitel=l/m,[r,l,h]}(function(t){let e=[],a=[];return t.datasets.forEach(t=>{e.push(Math.min(...t.data))}),a.push(e),e=[],t.datasets.forEach(t=>{e.push(Math.max(...t.data))}),a.push(e),a}(a.data)):s(function(t){let e=[],a=[];return t.datasets.forEach(t=>{e.push(Math.min(...t.data))}),a.push(Math.min(...e)),e=[],t.datasets.forEach(t=>{e.push(Math.max(...t.data))}),a.push(Math.max(...e)),a}(t)),"min"==e)return i[0];if("max"==e)return i[1];if("step"==e)return i[2];if("all"==e)return i;function s(t){let e=t[1]-t[0],a=Math.floor(e/5.9),i=a.toString().length-1,s=Math.ceil(a/10**i)*10**i,h=Math.floor(t[0]/10**i)*10**i;return[h,h+6*s>0?h+6*s:0,s]}},l=function(t,e,a,i){function s(e,i){let s=0;for(let e=0;e<t.data.datasets.length;e++)s+=a?Math.ceil(t.data.datasets[e].data[i]):Math.ceil(t.data.view.datasets[e].data[i]);return s-=Math.ceil(t.minValue)}function h(e,i){let s;s=0;for(let h=0;h<=e;h++)s+=a?Math.ceil(t.data.datasets[h].data[i]):Math.ceil(t.data.view.datasets[h].data[i]);return s-=Math.ceil(t.minValue)}t.svgPaths=[],t.dots=[],"line"==t.data.type&&function(){let i;t.data.options.y_scaled||(i=t.area.height/e);for(let s=0;s<t.data.view.datasets.length;s++){t.data.options.y_scaled&&(i=t.area.height/e,1==s&&(i=t.area.height/e*t.data.mnojitel));let h=new Path2D;t.svgPaths.push(h),h.strokeStyle=t.data.datasets[s].color;let r=a?t.data.datasets[s].data:t.data.view.datasets[s].data;for(let e=0;e<r.length;e++){let l=r[e]-t.minValue;t.data.options.y_scaled&&1==s&&(l=r[e]-t.data.secondYminmax[0]);let o=a?Math.ceil(0+e*t.stepX):Math.ceil((t.data.firstIndex+e)*t.stepX),n=Math.ceil(t.area.height-l*i);if(h.lineTo(o,n),!a)if(0==s){let a=t.data.view.datasets.map(t=>({value:t.data.filter((t,a)=>a==e)[0],color:t.color,name:t.name,y:n}));t.dots.push({x:o,y:n,xAxis:t.data.view.xAxis[e],values:a})}else 0!=s&&t.dots[e]&&(t.dots[e].values[s].y=n)}}}(),"bar"==t.data.type&&function(){let i=t.area.height/e;for(let e=0;e<t.data.datasets.length;e++){let s=new Path2D;t.svgPaths.push(s),s.strokeStyle=t.data.datasets[e].color;let h=a?t.data.datasets[e].data:t.data.view.datasets[e].data;s.lineTo(0-t.stepX/2,t.area.height);for(let r=0;r<h.length;r++){let l,o=Math.ceil((h[r]-t.minValue)*i),n=Math.ceil(h[r]*i);if(t.data.options.stacked){o=0;for(let s=0;s<=e;s++)o+=a?Math.ceil(t.data.datasets[s].data[r]*i):Math.ceil(t.data.view.datasets[s].data[r]*i);o-=Math.ceil(t.minValue*i)}l=a?Math.ceil(r*t.stepX+t.stepX/2+0):Math.ceil((t.data.firstIndex+r)*t.stepX);let d=Math.ceil(t.area.height-o),c=Math.ceil(n);if(s.rect(Math.ceil(l-t.stepX/2),d,Math.ceil(t.stepX),c),!a)if(0==e){let e=t.data.view.datasets.map(t=>({value:t.data.filter((t,e)=>e==r)[0],color:t.color,name:t.name,y:d}));t.dots.push({x:l,y:d,xAxis:t.data.view.xAxis[r],values:e})}else 0!=e&&t.dots[r]&&(t.dots[r].values[e].y=d)}}}(),"area"==t.data.type&&(t.chart.isZoom?function(){if(!a){let e=t.area.width/2,a=t.area.height/2,i=t.area.height>t.area.width?t.area.width/2-5:t.area.height/2-5,s=[],h=0;t.data.view.datasets.forEach(e=>{let a=new Path2D;t.svgPaths.push(a),a.strokeStyle=e.color,s.push(e.data.reduce((t,e,a)=>t+e,0))}),h=s.reduce((t,e,a)=>t+e,0);let r=0;s.forEach((s,l)=>{let o=2*Math.PI*s/h+r;t.svgPaths[l].moveTo(e,a),t.svgPaths[l].arc(e,a,i,r,o),t.svgPaths[l].closePath(),r+=2*Math.PI*s/h})}if(a){let e={},i={};for(let r=0;r<t.data.datasets.length;r++){let l,o;r?r<t.data.datasets.length-1?((l=t.svgPaths[r]).strokeStyle=t.data.datasets[r].color,o=new Path2D,t.svgPaths.push(o),l.lineTo(e.x,e.y)):((l=t.svgPaths[r]).strokeStyle=t.data.datasets[r].color,l.lineTo(e.x,e.y)):((l=new Path2D).strokeStyle=t.data.datasets[r].color,o=new Path2D,t.svgPaths.push(l),t.svgPaths.push(o),l.lineTo(0,t.area.height));let n=t.data.datasets[r].data;for(let d=0,c=n.length-1;d<n.length;d++,c--){let u=h(r,d)*t.area.height/s(r,d),m=h(r,c)*t.area.height/s(r,c),x=Math.ceil(0+d*t.stepX),g=Math.ceil(0+c*t.stepX),f=Math.ceil(t.area.height-u),p=Math.ceil(t.area.height-m);if(l.lineTo(x,f),o&&o.lineTo(g,p),d||(e.x=x,e.y=f),d==n.length-1&&(i.x=x,i.y=f),!a)if(0==r){let e=t.data.view.datasets.map(t=>({value:t.data.filter((t,e)=>e==d)[0],color:t.color,name:t.name,y:f}));t.dots.push({x:x,y:f,xAxis:t.data.view.xAxis[d],values:e})}else 0!=r&&t.dots[d]&&(t.dots[d].values[r].y=f)}r||l.lineTo((t.data.datasets[0].data.length-1)*t.stepX,t.area.height)}}}():function(){let e={},i={};for(let r=0;r<t.data.datasets.length;r++){let l,o;r?r<t.data.datasets.length-1?((l=t.svgPaths[r]).strokeStyle=t.data.datasets[r].color,o=new Path2D,t.svgPaths.push(o),l.lineTo(e.x,e.y)):((l=t.svgPaths[r]).strokeStyle=t.data.datasets[r].color,l.lineTo(e.x,e.y)):((l=new Path2D).strokeStyle=t.data.datasets[r].color,o=new Path2D,t.svgPaths.push(l),t.svgPaths.push(o),l.lineTo(0,t.area.height));let n=a?t.data.datasets[r].data:t.data.view.datasets[r].data;for(let d=0,c=n.length;d<n.length;d++,c--){let u=h(r,d)*t.area.height/s(r,d),m=h(r,c)*t.area.height/s(r,c),x=a?Math.ceil(0+d*t.stepX):Math.ceil((t.data.firstIndex+d)*t.stepX),g=a?Math.ceil(0+c*t.stepX):Math.ceil((t.data.firstIndex+c)*t.stepX),f=Math.ceil(t.area.height-u),p=Math.ceil(t.area.height-m);if(l.lineTo(x,f),o&&o.lineTo(g,p),d||(e.x=x,e.y=f),d==n.length-1&&(i.x=x,i.y=f),!a)if(0==r){let e=t.data.view.datasets.map(t=>({value:t.data.filter((t,e)=>e==d)[0],color:t.color,name:t.name,y:f}));t.dots.push({x:x,y:f,xAxis:t.data.view.xAxis[d],values:e,index:t.data.firstIndex+d})}else 0!=r&&t.dots[d]&&(t.dots[d].values[r].y=f)}r||l.lineTo((t.data.datasets[0].data.length-1)*t.stepX,t.area.height)}}())};class o{constructor(t){this.chart=t,this.area=t.geometry.ChartArea,this.chartCtx=s(this,"ChartArea_chart_"),this.yAxisCtx=s(this,"ChartArea_yAxis_"),this.dynamicCtx=s(this,"ChartArea_dynamic_"),this.toolTip=this.makeToolTip(),this.data=t.data,this.svgPaths=[],this.dots=[],this.maxValue=null,this.minValue=null,this.moveDirection=null,this.xScale=null}makeToolTip(){let t=document.createElement("div");return t.id="ChartArea_toolTip_"+this.chart.id,t.className="tooltip",this.chart.root.appendChild(t),t}render(t){if(this.chart.Header.setDate(this.data.view.xAxis),this.xScale=(this.data.lastPixel-this.data.firstPixel)/this.area.width,this.stepX=this.area.width/this.xScale/this.data.xAxis.length,this.chart.isZoom&&"area"==this.data.type||this.chart.LabelX.render(),this.duringAnim||(this.oldMaxValue=this.maxValue||0,this.oldMinValue="number"==typeof this.minValue?this.minValue:r(this.data.view,"min",this),this.minYScale=1),this.minValue=r(this.data.view,"min",this),this.minDif=this.minValue-this.oldMinValue,this.maxValue=r(this.data.view,"max",this)-this.minValue,this.maxOldScale=this.maxYScale,this.maxYScale=this.oldMaxValue/this.maxValue,this.duringAnim)return void(this.maxYScale=1==this.maxYScale?this.maxOldScale:this.maxYScale);let e,a=this.maxValue*this.maxYScale,i=this.maxYScale;const s=()=>{this.duringAnim=!0,this.minYScale*=2**(1/30),e=this.minDif*(2-this.minYScale),a/=this.maxYScale**(1/30),i/=this.maxYScale**(1/30),(this.maxYScale>1&&a<=this.maxValue||this.maxYScale<1&&a>this.maxValue)&&(a=this.maxValue,i=1),this.minYScale>=2&&(e=0,i=1),this.drawChart(a,e*this.area.height/a),this.chart.isZoom&&"area"==this.data.type||this.renderLines(this.yAxisCtx,i),a&&a!=this.maxValue||e?requestAnimationFrame(s):this.duringAnim=!1};s()}drawChart(t,e){this.clear(this.chartCtx),l(this,t,!1,e),this.svgPaths.forEach(t=>{this.chartCtx.save(),"area"==this.data.type&&this.chart.isZoom||(this.chartCtx.translate(-this.data.firstPixel/this.xScale,0),this.chartCtx.translate(0,-e)),this.chartCtx.lineWidth=3,this.chartCtx.lineJoin="round","bar"==this.data.type||"area"==this.data.type?(this.chartCtx.globalAlpha=.75,this.chartCtx.fillStyle=t.strokeStyle,this.chartCtx.fill(t)):(this.chartCtx.strokeStyle=t.strokeStyle,this.chartCtx.stroke(t)),this.chartCtx.restore()})}renderLines(t,e){this.clear(t),t.save(),t.beginPath(),t.strokeStyle="#ddeaf3",this.drawLines(t,e),t.closePath(),t.stroke(),t.restore()}drawLines(t,e){let a=r(this.data.view,"all",this),i=a[0],s=a[2];t.save(),t.fillStyle="#647080",t.font="16px sans-serif",this.data.options.percentage?(t.moveTo(this.area.left,this.area.height),t.fillText(0,this.area.left,this.area.height-5),t.lineTo(this.area.right,this.area.height),t.moveTo(this.area.left,.75*this.area.height),t.fillText(25,this.area.left,.75*this.area.height-5),t.lineTo(this.area.right,.75*this.area.height),t.moveTo(this.area.left,.5*this.area.height),t.fillText(50,this.area.left,.5*this.area.height-5),t.lineTo(this.area.right,.5*this.area.height),t.moveTo(this.area.left,.25*this.area.height),t.fillText(75,this.area.left,.25*this.area.height-5),t.lineTo(this.area.right,.25*this.area.height),t.moveTo(this.area.left,0),t.fillText(100,this.area.left,20),t.lineTo(this.area.right,0)):(t.moveTo(this.area.left,this.area.height*e),t.lineTo(this.area.right,this.area.height*e),t.moveTo(this.area.left,this.area.height*e*.833),t.lineTo(this.area.right,this.area.height*e*.833),t.moveTo(this.area.left,this.area.height*e*.666),t.lineTo(this.area.right,this.area.height*e*.666),t.moveTo(this.area.left,this.area.height*e*.5),t.lineTo(this.area.right,this.area.height*e*.5),t.moveTo(this.area.left,this.area.height*e*.333),t.lineTo(this.area.right,this.area.height*e*.333),t.moveTo(this.area.left,this.area.height*e*.166),t.lineTo(this.area.right,this.area.height*e*.166),this.data.options.y_scaled&&this.data.secondYminmax[1]?(t.save(),t.fillStyle=this.data.secondYminmax[0]<i?"#E8AF14":"#108BE3",t.fillText(this.numFormatter(this.data.secondYminmax[0]),this.area.right-45,this.area.height*e-5),t.fillText(this.numFormatter(this.data.secondYminmax[0]+this.data.secondYminmax[2]),this.area.right-45,this.area.height*e*.833-5),t.fillText(this.numFormatter(this.data.secondYminmax[0]+2*this.data.secondYminmax[2]),this.area.right-45,this.area.height*e*.666-5),t.fillText(this.numFormatter(this.data.secondYminmax[0]+3*this.data.secondYminmax[2]),this.area.right-45,this.area.height*e*.5-5),t.fillText(this.numFormatter(this.data.secondYminmax[0]+4*this.data.secondYminmax[2]),this.area.right-45,this.area.height*e*.333-5),t.fillText(this.numFormatter(this.data.secondYminmax[0]+5*this.data.secondYminmax[2]),this.area.right-45,this.area.height*e*.166-5),t.restore(),t.fillStyle=this.data.secondYminmax[0]>i?"#E8AF14":"#108BE3",t.fillText(this.numFormatter(i),this.area.left,this.area.height*e-5),t.fillText(this.numFormatter(i+s),this.area.left,this.area.height*e*.833-5),t.fillText(this.numFormatter(i+2*s),this.area.left,this.area.height*e*.666-5),t.fillText(this.numFormatter(i+3*s),this.area.left,this.area.height*e*.5-5),t.fillText(this.numFormatter(i+4*s),this.area.left,this.area.height*e*.333-5),t.fillText(this.numFormatter(i+5*s),this.area.left,this.area.height*e*.166-5)):(t.fillText(this.numFormatter(i),this.area.left,this.area.height*e-5),t.fillText(this.numFormatter(i+s),this.area.left,this.area.height*e*.833-5),t.fillText(this.numFormatter(i+2*s),this.area.left,this.area.height*e*.666-5),t.fillText(this.numFormatter(i+3*s),this.area.left,this.area.height*e*.5-5),t.fillText(this.numFormatter(i+4*s),this.area.left,this.area.height*e*.333-5),t.fillText(this.numFormatter(i+5*s),this.area.left,this.area.height*e*.166-5))),t.restore()}numFormatter(t){return t/1e6>=1?t/1e6+"M":t/1e3>=1?t/1e3+"k":t}findDot(t){let e;return this.dots.forEach(a=>{a.x-this.data.firstPixel/this.xScale<=t+this.stepX/2&&a.x-this.data.firstPixel/this.xScale>=t-this.stepX/2&&(e=a)}),e}showToolTip(t,e,a){this.clear(t);let i=this.findDot(e,a);if(i){t.save(),t.strokeStyle="#ddeaf3",t.fillStyle="rgb(255,255,255, 0.98)",t.lineWidth=2,"bar"!=this.data.type&&"area"!=this.data.type||(t.save(),i.values.forEach((e,a)=>{t.fillStyle=e.color,t.fillRect(i.x-this.data.firstPixel/this.xScale-this.stepX/2,e.y,this.stepX,i.values[a-1]?i.values[a-1].y-e.y:this.area.height-e.y)}),t.restore()),"line"==this.data.type&&(t.beginPath(),t.moveTo(i.x-this.data.firstPixel/this.xScale,0),t.lineTo(i.x-this.data.firstPixel/this.xScale,this.area.bottom),t.closePath(),t.stroke(),i.values.forEach(e=>{t.save(),t.beginPath(),t.strokeStyle=e.color,t.arc(i.x-this.data.firstPixel/this.xScale,e.y,3,0,2*Math.PI),t.fill(),t.closePath(),t.stroke(),t.restore()}));let s=this.renderToolTip(i);e>=this.area.width-s.width/2?this.toolTip.style.left=this.area.width-s.width-2+"px":e<s.width/2?this.toolTip.style.left="0px":this.toolTip.style.left=e-s.width/2+"px",a<=this.area.height/2?this.toolTip.style.top=this.area.height+this.area.top-s.height-2+"px":this.toolTip.style.top=this.area.top+"px",this.toolTip.style.display="block"}}renderToolTip(t){let e=18*t.values.length+20+20;return this.dot!=t&&(this.toolTip.innerHTML=`\n            <div class="caption" id="${"ChartArea_toolTip_caption"+this.chart.id}">${t.xAxis.full}</div>\n            <div class="oldCaption">${this.dot?this.dot.xAxis.full:""}</div>\n            ${t.values.map((t,e)=>`\n                    <div id="${"ChartArea_toolTip_item"+this.chart.id+"_"+e}">${t.name}: \n                        <span id="${"ChartArea_toolTip_num"+this.chart.id+"_"+e}" style="color: ${t.color}">\n                            ${t.value}\n                        </span>\n                        ${this.dot?`<span class="old" style="color: ${this.dot.values[e].color}">\n                            ${this.dot.values[e].value}\n                        </span>`:""}\n                    </div>`).join("")}\n            `),this.toolTip.style.width="200px",this.toolTip.style.height=e+"px",this.dot=t,{width:200,height:e}}update(t,e,a){"CANVAS"==a.target.tagName||this.chart.isZoom||"touchstart"!=a.type?"mousemove"==a.type||"touchmove"==a.type||"touchstart"==a.type?(this.changingCursor(t,e),this.showToolTip(this.dynamicCtx,t,e)):"click"!=a.type||a.sourceCapabilities.firesTouchEvents||this.chart.isZoom||this.chart.zoomIn(this.findDot(t)):this.chart.zoomIn(this.dot)}changingCursor(t,e){this.chart.isZoom&&"area"==this.data.type?this.chart.root.style.cursor="default":this.chart.root.style.cursor="crosshair"}clear(t){t.clearRect(0,0,this.area.width,this.area.height)}}class n{constructor(t){this.chart=t,this.area=t.geometry.ChartPreview,this.previewPadCtx=s(this,"ChartPreview_pad_"),this.data=t.data,this.minWidth=30,this.chart.isZoom&&5!=this.chart.id?(this.start=this.area.width/7*3,this.finish=this.area.width/7*4,4==this.chart.id&&(this.start=0,this.finish=this.area.width)):"area"==this.chart.data.type&&this.chart.isZoom?(this.start=this.area.width/7*6,this.finish=this.area.width,this.minWidth=this.area.width/10):(this.start=this.area.width/12*11,this.finish=this.area.width),this.width=this.finish-this.start,this.border=8,this.borderMiss=5,this.isDragginsStart=!1,this.isDragginsFinish=!1,this.isDraggins=!1,this.init()}init(){this.setViewData(),this.makePad(this.start,this.width)}update(t,e,a){"touchstart"!=a.type&&"mousedown"!=a.type||(t<this.start+this.border+this.borderMiss&&t>this.start-this.borderMiss?this.isDragginsStart=!0:t<this.finish+this.borderMiss&&t>this.finish-this.border-this.borderMiss?this.isDragginsFinish=!0:t>this.start+this.border+this.borderMiss&&t<this.finish-this.border-this.borderMiss&&(this.isDraggins=!0)),"touchend"!=a.type&&"mouseup"!=a.type||(this.isDragginsStart=!1,this.isDragginsFinish=!1,this.isDraggins=!1),"touchmove"!=a.type&&"mousemove"!=a.type||(this.changingCursor(t,e),this.changePadSize(t,e,a))}changingCursor(t,e){t<this.start+this.border+this.borderMiss&&t>this.start-this.borderMiss?this.chart.root.style.cursor="w-resize":t<this.finish+this.borderMiss&&t>this.finish-this.border-this.borderMiss?this.chart.root.style.cursor="w-resize":t>this.start+this.border+this.borderMiss&&t<this.finish-this.border-this.borderMiss?this.chart.root.style.cursor="pointer":this.chart.root.style.cursor="default"}changePadSize(t,e,a){this.isDragginsStart&&(this.start=t,t>this.finish-this.minWidth?this.start=this.finish-this.minWidth:t<0&&(this.start=0),this.width=this.finish-this.start,this.makePad(this.start,this.width,"scalling",a)),this.isDragginsFinish&&(this.finish=t,t<this.start+this.minWidth?this.finish=this.start+this.minWidth:t>this.area.width&&(this.finish=this.area.width),this.width=this.finish-this.start,this.makePad(this.start,this.width,"scalling",a)),this.isDraggins&&this.replacePad(t,e,a)}replacePad(t,e,a){this.start=t-Math.floor(this.width/2),this.start<this.area.left&&(this.start=0),this.finish=this.start+this.width,this.finish>this.area.right&&(this.finish=this.area.right,this.start=this.finish-this.width),this.makePad(this.start,this.width,"replace",a)}setViewData(t,e){let a;this.data.firstPixel=this.start,this.data.lastPixel=this.finish,this.chart.isZoom&&"area"==this.data.type?(a=Math.round(this.start/this.area.width*this.data.xAxis.length),this.data.firstIndex=a>0?a:0,a=Math.round(this.finish/this.area.width*this.data.xAxis.length),this.data.lastIndex=a<this.data.xAxis.length?a+1:this.data.xAxis.length):(a=Math.floor(this.start/this.area.width*this.data.xAxis.length),this.data.firstIndex=a>0?a:0,a=Math.ceil(this.finish/this.area.width*this.data.xAxis.length),this.data.lastIndex=a<this.data.xAxis.length?a+1:this.data.xAxis.length),this.data.view={datasets:this.data.datasets.map(t=>({data:t.data.slice(this.data.firstIndex,this.data.lastIndex),color:t.color,name:t.name})),xAxis:this.data.xAxis.slice(this.data.firstIndex,this.data.lastIndex)},this.chart.ChartArea.render(e)}makePad(t,e,a,i){this.previewPadCtx.save(),this.previewPadCtx.clearRect(this.area.left,0,this.area.width,this.area.height),this.previewPadCtx.fillStyle="rgb(245,249,251, 0.7)",this.previewPadCtx.fillRect(this.area.left,0,this.area.width,this.area.height),this.previewPadCtx.fillStyle="rgb(221,234,243, 0.7)",this.previewPadCtx.fillRect(t,0,e,this.area.height),this.previewPadCtx.fillStyle="#fff",this.previewPadCtx.clearRect(t+this.border,1,e-2*this.border,this.area.height-3),this.previewPadCtx.restore(),this.setViewData(a,i)}}class d{constructor(t){this.chart=t,this.area=t.geometry.ChartPreview,this.previewCtx=s(this,"ChartPreview_"),this.data=t.data,this.pad=new n(t),this.svgPaths=[],this.minValue=r(this.data,"min",this)}update(t,e,a){this.pad.update(t,e,a)}clear(){this.previewCtx.clearRect(0,0,this.area.width,this.area.height)}drawChart(t){this.clear(),l(this,t,!0),this.svgPaths.forEach(t=>{this.previewCtx.save(),this.previewCtx.lineJoin="round","bar"==this.data.type||"area"==this.data.type?(this.previewCtx.globalAlpha=.75,this.previewCtx.fillStyle=t.strokeStyle,this.previewCtx.fill(t)):(this.previewCtx.strokeStyle=t.strokeStyle,this.previewCtx.stroke(t)),this.previewCtx.restore()})}render(){this.stepX=this.area.width/(this.data.xAxis.length-1),this.duringAnim||(this.oldMaxValue=this.maxValue||r(this.data,"max",this)-this.minValue),this.minValue=r(this.data,"min",this),this.maxValue=r(this.data,"max",this)-this.minValue,this.maxYScale=this.oldMaxValue/this.maxValue;let t=this.maxValue*this.maxYScale;const e=()=>{this.duringAnim=!0,t/=this.maxYScale**.05,(this.maxYScale>1&&t<=this.maxValue||this.maxYScale<1&&t>this.maxValue)&&(t=this.maxValue),this.drawChart(t),t&&t!=this.maxValue?requestAnimationFrame(e):this.duringAnim=!1};e()}}class c{constructor(t){this.chart=t,this.area=t.geometry.Buttons,this.data=t.data,this.buttonsPlace=this.makeButtonsPlace("Buttons_"),this.buttons={},this.makeButtons()}makeButtonsPlace(t){let e=document.createElement("div");return e.id=t+this.chart.id,e.className="buttons",e.style.position="absolute",e.style.top=this.area.top+10+"px",e.style.left=this.area.left,e.style.width=this.area.width+"px",this.chart.root.appendChild(e),e}countOnCharts(){return this.data.buttons.filter(t=>t.active).length}update(t,e,a){if("click"==a.type){let t=a.target.id.replace("Buttons_",""),e=this.data.buttons.filter(e=>e.text==t)[0];if(e)if(e.active){if(1==this.countOnCharts())return;this.offDataset(t)}else this.onDataset(t)}"touchmove"!=a.type&&"mousemove"!=a.type||(this.chart.root.style.cursor="default")}offDataset(t){let e=this.data.buttons.filter(e=>e.text==t)[0];e.active=!1,this.setStyles(e),this.data.view={datasets:this.data.view.datasets.filter(e=>e.name!==t),xAxis:this.data.view.xAxis},this.data.datasets=this.data.datasets.filter(e=>e.name!==t),this.chart.ChartPreview.render(this.chart.staticCtx),this.chart.ChartArea.render()}onDataset(t){let e=this.data.buttons.filter(e=>e.text==t)[0];e.active=!0,this.setStyles(e);let a=this.data.source.datasets.filter(e=>e.name==t)[0];this.data.view.datasets.push({data:a.data.slice(this.data.firstIndex,this.data.lastIndex),color:a.color,name:a.name}),this.data.datasets.push(a),this.chart.ChartPreview.render(this.chart.staticCtx),this.chart.ChartArea.render()}clear(){this.ctx.clearRect(0,0,this.area.width,this.area.height)}makeButtons(){this.data.buttons.forEach(t=>{let e=document.createElement("button"),a=document.createElement("div");e.id=a.id="Buttons_"+t.text,e.textContent=t.text,a.className="icon",e.appendChild(a),this.buttonsPlace.appendChild(e),t.button=e,t.circle=a,this.setStyles(t)}),this.buttonsPlace.clientHeight>this.area.height&&(this.chart.root.style.height=this.chart.root.clientHeight+this.buttonsPlace.clientHeight-this.area.height+30+"px")}setStyles(t){t.active?(t.button.style.backgroundColor=t.color,t.button.style.border="1px solid "+t.color,t.button.style.color="white"):(t.button.style.backgroundColor="initial",t.button.style.border="1px solid "+t.color,t.button.style.color=t.color)}}class u{constructor(t){this.chart=t,this.data=t.data,this.area=t.geometry.Header,this.headerPlace=this.makeHeaderPlace(),t.isZoom?this.zoomOut=this.makeZoomOut(this.headerPlace):this.title=this.makeTitle(this.headerPlace),this.date=this.makeDate(this.headerPlace)}makeHeaderPlace(){let t=document.createElement("div");return t.className="header",t.style.width=this.area.width+"px",t.style.height=this.area.height+"px",t.style.position="absolute",t.style.top=this.area.top+"px",t.style.left=this.area.left+"px",t.style.textAlign="left",this.chart.root.appendChild(t),t}makeTitle(t){let e=document.createElement("div");return e.className="title",e.innerText="Chart_Name",e.style.display="inline-block",t.appendChild(e),e}makeZoomOut(t){let e=document.createElement("div");return e.id="Header_zoomOut",e.className="zoomOut",e.innerText="Zoom Out",e.style.display="inline-block",t.appendChild(e),e}makeDate(t){let e=document.createElement("div");return e.className="date",e.innerText="Date",e.style.display="inline-block",e.style.float="right",t.appendChild(e),e}setDate(t){this.dateValue!=t&&t.length&&(this.date.innerText=t[0].full+" - "+t[t.length-1].full,this.dateValue=t,1==t.length&&(this.date.innerText=t[0].full))}update(t,e,a){"mousemove"==a.type&&(this.chart.root.style.cursor="default"),"click"==a.type&&this.chart.isZoom&&this.chart.zoomOut()}}class m{constructor(t){this.chart=t,t.root.addEventListener("click",this.event.bind(this),!1),t.root.addEventListener("mousedown",this.event.bind(this),!1),t.root.addEventListener("mouseup",this.event.bind(this),!1),t.root.addEventListener("mousemove",this.event.bind(this),!1),t.root.addEventListener("touchstart",this.event.bind(this),!1),t.root.addEventListener("touchend",this.event.bind(this),!1),t.root.addEventListener("touchmove",this.event.bind(this),!1),t.root.addEventListener("mouseleave",this.event.bind(this),!1),t.root.addEventListener("mouseout",this.event.bind(this),!1)}event(t){if(t.stopPropagation(),~t.type.indexOf("touch")){if(!t.touches.length)return this.spreader(this.chart.geometry,null,null,t);let e=(t.target||t.srcElement).getBoundingClientRect(),a=Math.ceil(t.touches[0].clientX-e.left),i=Math.ceil(t.touches[0].clientY-e.top);this.spreader(this.chart.geometry,a,i,t)}else{let e=(t.target||t.srcElement).getBoundingClientRect(),a=Math.ceil(t.clientX-e.left),i=Math.ceil(t.clientY-e.top);this.spreader(this.chart.geometry,a,i,t)}window.getSelection().removeAllRanges()}spreader(t,e,a,i){let s=i.target.id.split("_")[0];this.chart[s]&&this.chart[s].update(e,a,i),"mouseup"!=i.type&&"mouseout"!=i.type||(this.chart.ChartPreview.pad.isDraggins=!1,this.chart.ChartPreview.pad.isDragginsFinish=!1,this.chart.ChartPreview.pad.isDragginsStart=!1,this.chart.ChartArea.toolTip.style.display="none",this.chart.ChartArea.showToolTip(this.chart.ChartArea.dynamicCtx))}}var x=function(t,e){let a=0,i=l(null,.075),s=l(i,.6),h=l(s,.075),r=l(h,.1);return{Header:i,ChartArea:s,LabelX:h,ChartPreview:r,Buttons:l(r,.15)};function l(i,s){return{width:t-a,height:e*s-a,top:i?i.bottom+a:a/2,bottom:i?i.bottom+a+e*s:e*s+a,right:t-a/2,left:a/2}}},g=function(t,e){let a;a=e.isZoom&&5!=e.id?t.columns[0].slice(1).map(t=>new Date(t)).map(t=>{let e=t.getHours()>9?t.getHours():"0"+t.getHours(),a=t.getMinutes()>9?t.getMinutes():"0"+t.getMinutes();return{short:e+":"+a,full:e+":"+a}}):t.columns[0].slice(1).map(t=>new Date(t)).map(t=>({short:t.toDateString().split(" ").slice(1,3).join(" "),full:t.toDateString()}));let i=t.columns.map((e,a)=>({data:e.slice(1),color:t.colors[t.columns[a][0]],name:t.names[t.columns[a][0]]})).slice(1),s=[];for(const e in t.names)t.names.hasOwnProperty(e)&&s.push({text:t.names[e],color:t.colors[e],active:!0});return{xAxis:a,datasets:i,buttons:s,source:{xAxis:a,datasets:i},type:t.types.y0,options:{percentage:!!t.percentage,stacked:!!t.stacked,y_scaled:!!t.y_scaled}}};class f{constructor(t,e,a,i,s){if(this.isZoom=a||!1,a&&(this.fullChart=i),this.id=e+1,this.width=window.innerWidth-36,this.height=window.innerHeight>720?720:window.innerHeight,this.root=this.makeRoot(),5==this.id&&a){this.data=JSON.parse(JSON.stringify(i.data));let t=i.data.datasets[0].data.length-8<s.index?i.data.datasets[0].data.length:s.index+1;this.data.datasets.forEach(e=>{e.data=e.data.slice(t-7,t)}),this.data.xAxis=this.data.xAxis.slice(t-7,t)}else this.data=g(t,this);this.geometry=x(this.width,this.height),this.Header=new u(this),this.ChartArea=new o(this),this.LabelX=new h(this),this.ChartPreview=new d(this),this.Buttons=new c(this),this.EventController=new m(this)}makeRoot(){let t=document.createElement("div");return t.style.display="inline-block",this.isZoom?(t.className="shown",this.fullChart.root.appendChild(t)):document.querySelector("#root").appendChild(t),t.style.position="relative",t.style.width=this.width+"px",t.style.height=this.height+"px",t.id="chart_"+this.id,t}render(){this.ChartPreview.render(this.staticCtx)}zoomIn(t){if(console.log(this),t){Array.from(this.root.getElementsByTagName("canvas")).forEach(t=>{t.className="hidden"}),this.root.querySelector(".tooltip").style.display="none",this.root.querySelector(".header").style.display="none",this.root.querySelector(".buttons").style.display="none";let e=new Date(t.xAxis.full);"area"==this.data.type?this.Zoom=new f(this.data.sourceTemp,this.id-1,!0,this,t).render():i(this.setUrl(e)).then(t=>{setTimeout(()=>{this.Zoom=new f(JSON.parse(t),this.id-1,!0,this).render()},400)})}}zoomOut(){this.destroy(),Array.from(this.fullChart.root.getElementsByTagName("canvas")).forEach(t=>{t.className="shown"}),this.fullChart.root.querySelector(".header").style.display="block",this.fullChart.root.querySelector(".buttons").style.display="block"}destroy(){this.root.remove()}setUrl(t){return`data/contest/${this.id}/${t.getFullYear()+"-"+(t.getMonth()>8?t.getMonth()+1:"0"+(t.getMonth()+1))}/${t.getDate()>9?t.getDate():"0"+t.getDate()}.json`}}const p="onorientationchange"in window?"orientationchange":"resize";let y=[];for(let t=0;t<5;t++)y.push(i(`data/contest/${t+1}/overview.json`));function v(){document.querySelector("#root").innerHTML="",y.forEach((t,e)=>{new f(t,e).render()})}Promise.all(y).then(t=>{y=[],t.forEach(t=>{y.push(JSON.parse(t))}),v()}),window.addEventListener(p,()=>{"resize"==p?v():new window.Promise(function(t){const e=(a,i)=>{window.innerHeight!=i||a>=120?t():window.requestAnimationFrame(()=>e(a+1,i))};e(0,window.innerHeight)}).then(()=>{v()})});let w=!1;document.querySelector("#switchMode").addEventListener("click",t=>{w?(w=!1,document.body.className="day",Array.from(document.getElementsByClassName("tooltip")).forEach(t=>t.className="tooltip day")):(w=!0,document.body.className="night",Array.from(document.getElementsByClassName("tooltip")).forEach(t=>t.className="tooltip night"))},!1)}]);